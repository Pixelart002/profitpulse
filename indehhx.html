<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Blogging Assistant</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <script>
    function gapiLoaded() {
      gapi.load('client', async () => {
        await gapi.client.init({ discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/blogger/v3/rest"] });
      });
    }
    
    function gisLoaded() {
      tokenClient = google.accounts.oauth2.initTokenClient({
        client_id: CLIENT_ID,
        scope: SCOPES,
        callback: async (tokenResponse) => {
          gapi.client.setToken(tokenResponse);
          document.getElementById('editor').style.display = 'block';
          loadUserBlogs();
        }
      });
    }
  </script>
  <script src="https://apis.google.com/js/api.js" onload="gapiLoaded()" async defer></script>
  <script src="https://accounts.google.com/gsi/client" onload="gisLoaded()" async defer></script>
  <style>
    .glass {
      backdrop-filter: blur(10px);
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .typing-indicator {
      animation: blink 1.5s infinite;
    }
    
    @keyframes blink {

      0%,
      100% {
        opacity: 0.2;
      }
      
      50% {
        opacity: 1;
      }
    }
  </style>
</head>

<body class="bg-gray-900 text-white font-sans">
  <div class="min-h-screen flex flex-col items-center p-6">
    <header class="w-full max-w-5xl mb-6">
      <h1 class="text-4xl font-bold mb-2">AI Blogging Assistant</h1>
      <p class="text-gray-400">Generate SEO-optimized blog content with AI in seconds</p>
    </header>
    
    <main class="w-full max-w-5xl glass rounded-2xl p-6">
      <button onclick="handleAuthClick()" class="mb-4 bg-green-600 hover:bg-green-700 px-4 py-2 rounded">Login with Google</button>
      
      <div id="editor" style="display:none;">
        <div class="mb-4">
          <label class="block text-sm mb-2">Select Your Blog</label>
          <select id="blogSelect" class="w-full p-3 rounded bg-gray-800 border border-gray-600 text-white"></select>
        </div>
      </div>
      
      <div class="mb-4">
        <label class="block text-sm mb-2">Blog Topic / Keywords</label>
        <input id="topicInput" type="text" placeholder="e.g. AI in Healthcare" class="w-full p-3 rounded bg-gray-800 border border-gray-600 text-white">
      </div>
      
      <div class="mb-4">
        <label class="block text-sm mb-2">Select AI Model</label>
        <select id="modelSelect" class="w-full p-3 rounded bg-gray-800 border border-gray-600 text-white">
          <option value="gpt-4o">GPT-4o (Advanced)</option>
          <option value="gpt-3.5-turbo">GPT-3.5 Turbo (Faster)</option>
        </select>
      </div>
      
      <button onclick="generateContent()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded font-bold">Generate Content</button>
      
      <div id="loading" class="mt-4 hidden text-blue-400 typing-indicator">Generating...</div>
      
      <div id="resultModal" class="hidden fixed top-0 left-0 w-full h-full bg-black bg-opacity-70 flex items-center justify-center z-50">
        <div class="bg-gray-800 rounded-lg p-6 w-full max-w-3xl relative">
          <button onclick="document.getElementById('resultModal').classList.add('hidden')" class="absolute top-2 right-4 text-white text-2xl">&times;</button>
          <div id="result" class="whitespace-pre-wrap space-y-6 max-h-[70vh] overflow-y-auto"></div>
        </div>
      </div>
    </main>
  </div>
  
  <script>
    const CLIENT_ID = '412947443263-vknfq5nikk8trse6ogri9lki7nna0jic.apps.googleusercontent.com';
    const SCOPES = 'https://www.googleapis.com/auth/blogger';
    const API_KEY = '6a91380587a74df6a786ce302cb74e0d';
    
    let tokenClient;
    
    function handleAuthClick() {
      tokenClient.requestAccessToken();
    }
    
    async function loadUserBlogs() {
      const res = await gapi.client.blogger.blogs.listByUser({ userId: 'self' });
      const blogs = res.result.items;
      const select = document.getElementById('blogSelect');
      select.innerHTML = '';
      blogs.forEach(blog => {
        const option = document.createElement('option');
        option.value = blog.id;
        option.textContent = blog.name;
        select.appendChild(option);
      });
    }
    
    async function generateContent() {
      const topic = document.getElementById('topicInput').value.trim();
      const model = document.getElementById('modelSelect').value;
      const loading = document.getElementById('loading');
      const result = document.getElementById('result');
      const resultModal = document.getElementById('resultModal');
      
      if (!topic) return alert('Please enter a topic or keyword.');
      
      loading.classList.remove('hidden');
      result.innerHTML = '';
      
      try {
        const response = await fetch("https://api.aimlapi.com/chat/completions", {
          method: "POST",
          headers: {
            "Authorization": `Bearer ${API_KEY}`,
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            model: model,
            messages: [
            {
              role: "system",
              content: `You are a smart AI blogging assistant...`
            },
            {
              role: "user",
              content: `Write a detailed, SEO-optimized blog article on: ${topic}`,
            }, ],
            max_tokens: 2048,
            temperature: 0.85,
            top_p: 1,
            frequency_penalty: 0,
            presence_penalty: 0.3,
            stream: false,
          }),
        });
        
        if (!response.ok) throw new Error("AI API Error: " + response.statusText);
        
        const data = await response.json();
        const outputText = data?.choices?.[0]?.message?.content || 'No response text found.';
        
        const title = outputText.split('\n').find(line => line.trim().length > 0) || 'Generated Blog Title';
        const content = outputText;
        
        result.innerHTML = `
          <input id="postTitle" value="${title}" class="w-full text-xl font-bold p-2 mb-2 bg-gray-800 text-white rounded" />
          <textarea id="postContent" class="w-full p-3 h-64 bg-gray-900 text-white rounded mb-2">${content}</textarea>
          <input id="youtubeUrl" type="text" placeholder="Optional YouTube Video URL" class="w-full mb-2 p-2 rounded bg-gray-800 text-white" />
          <input id="tags" type="text" placeholder="Optional Tags (comma-separated)" class="w-full mb-2 p-2 rounded bg-gray-800 text-white" />
          <input id="scheduleDate" type="datetime-local" class="w-full mb-4 p-2 rounded bg-gray-800 text-white" />
          <button onclick="publishToBlogger()" class="bg-green-600 px-4 py-2 rounded">Publish to Blogger</button>`;
        
        resultModal.classList.remove('hidden');
      } catch (error) {
        result.innerHTML = `<p class="text-red-500">Error: ${error.message}</p>`;
        resultModal.classList.remove('hidden');
      } finally {
        loading.classList.add('hidden');
      }
    }
    
    async function publishToBlogger() {
      const blogId = document.getElementById('blogSelect').value;
      const title = document.getElementById('postTitle').value;
      let content = document.getElementById('postContent').value;
      const videoUrl = document.getElementById('youtubeUrl').value;
      const tags = document.getElementById('tags').value.split(',').map(t => t.trim()).filter(t => t);
      const scheduleDate = document.getElementById('scheduleDate').value;
      
      if (videoUrl) content += `\n\n<iframe width="100%" height="315" src="${videoUrl}" frameborder="0" allowfullscreen></iframe>`;
      
      const post = {
        blog: { id: blogId },
        title: title,
        content: content,
        labels: tags.length ? tags : undefined,
        published: scheduleDate ? new Date(scheduleDate).toISOString() : undefined
      };
      
      try {
        await gapi.client.blogger.posts.insert({ blogId, resource: post });
        alert('Post published successfully!');
      } catch (err) {
        alert('Failed to publish: ' + err.message);
      }
    }
  </script>
</body>

</html>